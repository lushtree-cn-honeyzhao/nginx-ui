package utils

import (
	"log"
	"testing"
)

func TestCheckHttps(t *testing.T) {
	cert := "-----BEGIN CERTIFICATE-----\nMIIF+zCCBOOgAwIBAgIQAqW2QnAFhOUySMGo0ZRLCTANBgkqhkiG9w0BAQsFADBu\nMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\nd3cuZGlnaWNlcnQuY29tMS0wKwYDVQQDEyRFbmNyeXB0aW9uIEV2ZXJ5d2hlcmUg\nRFYgVExTIENBIC0gRzEwHhcNMjMwNTIyMDAwMDAwWhcNMjQwNTIxMjM1OTU5WjAe\nMRwwGgYDVQQDExNnaXQudG9ueWFuZG1vbmV5LmNuMIIBIjANBgkqhkiG9w0BAQEF\nAAOCAQ8AMIIBCgKCAQEAnqwdJ6Z6kuF4pUKsnXa8IWSngKYpUoz+2kvBqgvx30WE\nSRLB2Am8aHoLc53ecgwPFPsPLILPc2+xYGCoVNbbjIgBHND5VN/VicIGK1Jyg+j9\nhsI89EeoPIIf+5TbQO0EbVQSPdmyb418Xye1ST4VY5SNaxWvSDTtaMcCs5OeeDvV\nph0e3Zs3Jqb4AOc+6CQMrW1/uZByirCfiAtmGMqqzrA3JJXC1N19quNZRIb8Cnil\n7IoqPrz34vXHLuu1viGA2lKVwPwsGgxn7M+oaM78anwcpgMRZwZWwBtV23XyZ0o4\n8VOZuWF0DGXsJRaq2CTQ/lDt5Dun+XUmsFPvP/73cwIDAQABo4IC4zCCAt8wHwYD\nVR0jBBgwFoAUVXRPsnJP9WC6UNHX5lFcmgGHGtcwHQYDVR0OBBYEFAjlwkELXVLf\nb1/vEwB0pkZCNE64MB4GA1UdEQQXMBWCE2dpdC50b255YW5kbW9uZXkuY24wDgYD\nVR0PAQH/BAQDAgWgMB0GA1UdJQQWMBQGCCsGAQUFBwMBBggrBgEFBQcDAjA+BgNV\nHSAENzA1MDMGBmeBDAECATApMCcGCCsGAQUFBwIBFhtodHRwOi8vd3d3LmRpZ2lj\nZXJ0LmNvbS9DUFMwgYAGCCsGAQUFBwEBBHQwcjAkBggrBgEFBQcwAYYYaHR0cDov\nL29jc3AuZGlnaWNlcnQuY29tMEoGCCsGAQUFBzAChj5odHRwOi8vY2FjZXJ0cy5k\naWdpY2VydC5jb20vRW5jcnlwdGlvbkV2ZXJ5d2hlcmVEVlRMU0NBLUcxLmNydDAJ\nBgNVHRMEAjAAMIIBfgYKKwYBBAHWeQIEAgSCAW4EggFqAWgAdgDuzdBk1dsazsVc\nt520zROiModGfLzs3sNRSFlGcR+1mwAAAYhC2gJ1AAAEAwBHMEUCIQC+T9sZzjrh\nG0w9RHpynzrADkHszdHsjE51iMOQH3c0dwIgaF2seB6a5jBvWUuWXfmj67tvaETp\nNzmRI5UgF/4ixIwAdgBIsONr2qZHNA/lagL6nTDrHFIBy1bdLIHZu7+rOdiEcwAA\nAYhC2gKzAAAEAwBHMEUCIACpE81L/fVSvSEx+boDHLmSyQopjqEnKLN5vPMAKzfy\nAiEA2h/Tb80IPJxsWWNcu1+9F2krx8DO2gpalbvgyFKAq1gAdgDatr9rP7W2Ip+b\nwrtca+hwkXFsu1GEhTS9pD0wSNf7qwAAAYhC2gJ/AAAEAwBHMEUCIQC4RKjnHNLV\n3KQQa34wEWD3KFHB0k9sTJHacm4m9rSPWQIgcSJagfgp93hRoiNqWb+Isvipcl+I\nfjt3bhrzhMIlaDUwDQYJKoZIhvcNAQELBQADggEBAGCdGfIlmgLKj2V1GzV2IgZ/\nBP452NWeoafJFa0IdBOdqrSQ4iMuYFY/S8PAvIAzSXZiW+ZUna9faYJ7CmDIronG\nqK8lumPiJhTLq8AAdO5gnb3DcsnRGQVDXNFXZmk6drmrn5y3bmtYy0ajAJ/Apamc\nQDa/voMjxALCb0dUXOOHV/p/qvc95n54neS39dm8UujzMitsGJi1I26q8qDuMj8T\nyu+GJjYS3Qwh53v7R8RgWPSWvzNSZWUMyUn+ntBatS6Jps25qP/F36wbAhyfK7Y8\nDWftSyKwccGvC+Bo85oddhvTiqlo3lMw9XHVaudSzCk8Uy9RBqx6FLSdzQE94lg=\n-----END CERTIFICATE-----\n-----BEGIN CERTIFICATE-----\nMIIEqjCCA5KgAwIBAgIQAnmsRYvBskWr+YBTzSybsTANBgkqhkiG9w0BAQsFADBh\nMQswCQYDVQQGEwJVUzEVMBMGA1UEChMMRGlnaUNlcnQgSW5jMRkwFwYDVQQLExB3\nd3cuZGlnaWNlcnQuY29tMSAwHgYDVQQDExdEaWdpQ2VydCBHbG9iYWwgUm9vdCBD\nQTAeFw0xNzExMjcxMjQ2MTBaFw0yNzExMjcxMjQ2MTBaMG4xCzAJBgNVBAYTAlVT\nMRUwEwYDVQQKEwxEaWdpQ2VydCBJbmMxGTAXBgNVBAsTEHd3dy5kaWdpY2VydC5j\nb20xLTArBgNVBAMTJEVuY3J5cHRpb24gRXZlcnl3aGVyZSBEViBUTFMgQ0EgLSBH\nMTCCASIwDQYJKoZIhvcNAQEBBQADggEPADCCAQoCggEBALPeP6wkab41dyQh6mKc\noHqt3jRIxW5MDvf9QyiOR7VfFwK656es0UFiIb74N9pRntzF1UgYzDGu3ppZVMdo\nlbxhm6dWS9OK/lFehKNT0OYI9aqk6F+U7cA6jxSC+iDBPXwdF4rs3KRyp3aQn6pj\npp1yr7IB6Y4zv72Ee/PlZ/6rK6InC6WpK0nPVOYR7n9iDuPe1E4IxUMBH/T33+3h\nyuH3dvfgiWUOUkjdpMbyxX+XNle5uEIiyBsi4IvbcTCh8ruifCIi5mDXkZrnMT8n\nwfYCV6v6kDdXkbgGRLKsR4pucbJtbKqIkUGxuZI2t7pfewKRc5nWecvDBZf3+p1M\npA8CAwEAAaOCAU8wggFLMB0GA1UdDgQWBBRVdE+yck/1YLpQ0dfmUVyaAYca1zAf\nBgNVHSMEGDAWgBQD3lA1VtFMu2bwo+IbG8OXsj3RVTAOBgNVHQ8BAf8EBAMCAYYw\nHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCMBIGA1UdEwEB/wQIMAYBAf8C\nAQAwNAYIKwYBBQUHAQEEKDAmMCQGCCsGAQUFBzABhhhodHRwOi8vb2NzcC5kaWdp\nY2VydC5jb20wQgYDVR0fBDswOTA3oDWgM4YxaHR0cDovL2NybDMuZGlnaWNlcnQu\nY29tL0RpZ2lDZXJ0R2xvYmFsUm9vdENBLmNybDBMBgNVHSAERTBDMDcGCWCGSAGG\n/WwBAjAqMCgGCCsGAQUFBwIBFhxodHRwczovL3d3dy5kaWdpY2VydC5jb20vQ1BT\nMAgGBmeBDAECATANBgkqhkiG9w0BAQsFAAOCAQEAK3Gp6/aGq7aBZsxf/oQ+TD/B\nSwW3AU4ETK+GQf2kFzYZkby5SFrHdPomunx2HBzViUchGoofGgg7gHW0W3MlQAXW\nM0r5LUvStcr82QDWYNPaUy4taCQmyaJ+VB+6wxHstSigOlSNF2a6vg4rgexixeiV\n4YSB03Yqp2t3TeZHM9ESfkus74nQyW7pRGezj+TC44xCagCQQOzzNmzEAP2SnCrJ\nsNE2DpRVMnL8J6xBRdjmOsC3N6cQuKuRXbzByVBjCqAA8t1L0I+9wXJerLPyErjy\nrMKWaBFLmfK/AHNF4ZihwPGOc7w6UHczBZXH5RFzJNnww+WnKuTPI0HfnVH8lg==\n-----END CERTIFICATE-----\n\n"

	certs, err := CheckHttps(cert)
	if err != nil {
		log.Panic(err)
	}
	print(certs.Subject.CommonName)
	print(certs.NotAfter.Format("2006-01-02 15:04"))
}
